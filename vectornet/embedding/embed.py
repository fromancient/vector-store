from transformers import LongformerTokenizer, LongformerModel
import torch

class TextToEmbedding:
    def __init__(self):
        self.max_token_size = 4098  # Maximum token size for the model
        self.tokenizer = LongformerTokenizer.from_pretrained("allenai/longformer-base-4096")
        self.model = LongformerModel.from_pretrained("allenai/longformer-base-4096")

    def embed(self, texts):
        embeded_datas = []
        embeddings = []
        original_datas = []

        for text in texts:
            inputs = self.tokenizer(text, return_tensors="pt", max_length=self.max_token_size, truncation=True)
            outputs = self.model(**inputs)
            embedding = outputs.last_hidden_state  # Shape: (batch_size, sequence_length, hidden_size)

            pooled_embedding = self.mean_pooling(embedding, inputs['attention_mask'])
            pooled_embedding_list = pooled_embedding.tolist()
            embeded_datas.append(text)
            embeddings.append(pooled_embedding_list)
            original_datas.append(text)

        return embeded_datas, embeddings, original_datas

    def mean_pooling(self, embedding, attention_mask):
        token_embeddings = embedding  # (batch_size, sequence_length, hidden_size)
        attention_mask = attention_mask.unsqueeze(-1)  # (batch_size, sequence_length, 1)

        summed_embeddings = torch.sum(token_embeddings * attention_mask, 1)  # (batch_size, hidden_size)
        summed_mask = torch.sum(attention_mask, 1)  # (batch_size, 1)

        pooled_embedding = summed_embeddings / summed_mask
        return pooled_embedding  # (batch_size, hidden_size)

    def chunk_text(self, text):

        words = text.split()
        chunks = []
        current_chunk = []

        for word in words:
            current_chunk.append(word)
            if len(current_chunk) >= self.max_token_size:
                chunks.append(' '.join(current_chunk))
                current_chunk = []

        if current_chunk:
            chunks.append(' '.join(current_chunk))

        return chunks

if __name__ == '__main__':
    texts=['A museum is an institution dedicated to displaying and/or preserving culturally or scientifically significant objects. Many museums have exhibitions of these objects on public display, and some have private collections that are used by researchers and specialists. Museums host a much wider range of objects than a library, and usually focus on a specific theme, such as the arts, science, natural history or local history. Public museums that host exhibitions and interactive demonstrations are often tourist attractions, and many attract large numbers of visitors from outside their host country, with the most visited museums in the world attracting millions of visitors annually. Since the establishment of the earliest known museum in ancient times, museums have been associated with academia and the preservation of rare items. Museums originated as private collections of interesting items, and not until much later did the emphasis on educating the public take root. == Etymology == The English word museum comes from Latin, and is pluralized as museums (or rarely, musea). It is originally from the Ancient Greek Μουσεῖον (mouseion), which denotes a place or temple dedicated to the muses (the patron divinities in Greek mythology of the arts), and hence was a building set apart for study and the arts, especially the Musaeum (institute) for philosophy and research at Alexandria, built under Ptolemy I Soter about 280 BC. == Purpose == The purpose of modern museums is to collect, preserve, interpret, and display objects of artistic, cultural, or scientific significance for the study and education of the public. To city leaders, an active museum community can be seen as a gauge of the cultural or economic health of a city, and a way to increase the sophistication of its inhabitants. To museum professionals, a museum might be seen as a way to educate the public about the museums mission, such as civil rights or environmentalism. Museums are, above all, storehouses of knowledge. In 1829, James Smithsons bequest funding the Smithsonian Institution stated that he wanted to establish an institution for the increase and diffusion of knowledge. In the late 19th century, museums of natural history exemplified the scientific drive for classifying life and interpreting the world. Their purpose was to gather examples from each field of knowledge for research and display. Concurrently, as American colleges expanded during the 19th century, they also developed their own natural history collections to support the education of their students. By the last quarter of the 19th century, scientific research in universities was shifting toward biological research on a cellular level, and cutting-edge research moved from museums to university laboratories. While many large museums, such as the Smithsonian Institution, are still respected as research centers, research is no longer a main purpose of most museums. While there is an ongoing debate about the purposes of interpretation of a museums collection, there has been a consistent mission to protect and preserve cultural artifacts for future generations. Much care, expertise, and expense is invested in preservation efforts to retard decomposition in ageing documents, artifacts, artworks, and buildings. All museums display objects that are important to a culture. As historian Steven Conn writes, To see the thing itself, with ones own eyes and in a public place, surrounded by other people having some version of the same experience, can be enchanting. Museum purposes vary from institution to institution. Some favor education over conservation, or vice versa. For example, in the 1970s, the Canada Science and Technology Museum favored education over the preservation of their objects. They displayed objects as well as their functions. One exhibit featured a historical printing press that a staff member used for visitors to create museum memorabilia. Some museums seek to reach a wide audience, such as a national or state museum, while others have specific audiences, like the LDS Church History Museum or local history organizations. Generally speaking, museums collect objects of significance that comply with their mission statement for conservation and display. Apart from questions of provenance and conservation, museums take into consideration the former use and status of an object. Religious or holy objects, for instance, are handled according to cultural rules. Jewish objects that contain the name of God may not be discarded, but need to be buried. Although most museums do not allow physical contact with the associated artifacts, there are some that are interactive and encourage a more hands-on approach. In 2009, Hampton Court Palace, a palace of Henry VIII, in England opened the council room to the general public to create an interactive environment for visitors. Rather than allowing visitors to handle 500-year-old objects, however, the museum created replicas, as well as replica costumes. The daily activities, historic clothing, and even temperature changes immerse the visitor in an impression of what Tudor life may have been. === Definitions === Major professional organizations from around the world offer some definitions as to what constitutes a museum, and their purpose. Common themes in all the definitions are public good and the care, preservation, and interpretation of collections. The International Council of Museums current definition of a museum (adopted in 2022): A museum is a not-for-profit, permanent institution in the service of society that researches, collects, conserves, interprets and exhibits tangible and intangible heritage. Open to the public, accessible and inclusive, museums foster diversity and sustainability. They operate and communicate ethically, professionally and with the participation of communities, offering varied experiences for education, enjoyment, reflection and knowledge sharing. The Canadian Museums Associations definition: A museum is a non-profit, permanent establishment, that does not exist primarily for the purpose of conducting temporary exhibitions and that is open to the public during regular hours and administered in the public interest for the purpose of conserving, preserving, studying, interpreting, assembling and exhibiting to the public for the instruction and enjoyment of the public, objects and specimens or educational and cultural value including artistic, scientific, historical and technological material. The United Kingdoms Museums Associations definition: Museums enable people to explore collections for inspiration, learning and enjoyment. They are institutions that collect, safeguard and make accessible artifacts and specimens, which they hold in trust for society. While the American Alliance of Museums does not have such a definition, their list of accreditation criteria to participate in their Accreditation Program states a museum must: Be a legally organized nonprofit institution or part of a nonprofit organization or government entity; Be essentially educational in nature; Have a formally stated and approved mission; Use and interpret objects or a site for the public presentation of regularly scheduled programs and exhibits; Have a formal and appropriate program of documentation, care, and use of collections or objects; Carry out the above functions primarily at a physical facility or site; Have been open to the public for at least two years; Be open to the public at least 1,000 hours a year; Have accessioned 80 percent of its permanent collection; Have at least one paid professional staff with museum knowledge and experience; Have a full-time director to whom authority is delegated for day-to-day operations; Have the financial resources sufficient to operate effectively; Demonstrate that it meets the Core Standards for Museums; Successfully complete the Core Documents Verification Program. Additionally, there is a legal definition of museum in United States legislation authorizing the establishment of the Institute of Museum and Library Services: Museum means a public, tribal, or private nonprofit institution which is organized on a permanent basis for essentially educational, cultural heritage, or aesthetic purposes and which, using a professional staff: Owns or uses tangible objects, either animate or inanimate; Cares for these objects; and Exhibits them to the general public on a regular basis (Museum Services Act 1976). == History == === Ancient === One of the oldest museums known is Ennigaldi-Nannas museum, built by Princess Ennigaldi in modern Iraq at the end of the Neo-Babylonian Empire. The site dates from c. 530 BC, and contained artifacts from earlier Mesopotamian civilizations. Notably, a clay drum label—written in three languages—was found at the site, referencing the history and discovery of a museum item. Ancient Greeks and Romans collected and displayed art and objects but perceived museums differently from modern-day views. In the classical period, the museums were the temples and their precincts which housed collections of votive offerings. Paintings and sculptures were displayed in gardens, forums, theaters, and bathhouses. In the ancient past there was little differentiation between libraries and museums with both occupying the building and were frequently connected to a temple or royal palace. The Museum of Alexandria is believed to be one of the earliest museums in the world. While it connected to the Library of Alexandria it is not clear if the museum was in a different building from the library or was part of the library complex. While little was known about the museum it was an inspiration for museums during the early Renaissance period. The royal palaces also functioned as a kind of museum outfitted with art and objects from conquered territories and gifts from ambassadors from other kingdoms allowing the ruler to display the amassed collections to guests and to visiting dignitaries. Also in Alexandria from the', 'The Museum of Illusions (Croatian: Muzej iluzija) is a franchise of museums that host a variety of exhibits of optical and other types of illusions. The first museum in the franchise was opened in 2015 in Zagreb, Croatia. As of May 2023, the franchise consists of 43 museums in 25 countries. The franchise is operated by Metamorfoza d.o.o., which is, as of 2021, majority-owned by Invera Equity Partners. == History == The idea for the museum was started by Tomislav Pamuković and Roko Živković after contemplating on how to escape the corporate environment and making something my own. According to them, it was inspired by the National Geographic television show Brain Games. The first museum opened in 2015 in Zagreb, Croatia, with two years passing between idea and realization. The franchising started in 2016 with museums opening in Zadar, Croatia and Ljubljana, Slovenia. The franchise later expanded into multiple countries, with the largest museum opening in September 2023 in Las Vegas, United States. == References == == External links == Official website', 'No extract available']
    emb = TextToEmbedding()
    embedding = emb.embed(texts)
    print(embedding)
